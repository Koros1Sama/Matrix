<!DOCTYPE html>
<html lang="ar" dir="ltr">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Koros Matrix - ูุนุจุฉ ุชุนููููุฉ</title>
    <link rel="icon" type="image/png" href="icon.png" />
    <link rel="apple-touch-icon" href="icon.png" />
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#6366F1" />
    <!-- Mobile App Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta
      name="description"
      content="ูุนุจุฉ ุชุนููููุฉ ุชูุงุนููุฉ ูุชุนูู ุญู ุฃูุธูุฉ ุงููุนุงุฏูุงุช ุงูุฎุทูุฉ ุจุทุฑููุฉ ุฌุงูุณ"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&family=Fira+Code:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/cinematic-tutorial.css" />
    <link rel="stylesheet" href="css/determinant.css" />
    <link rel="stylesheet" href="css/custom-level.css" />
    <link rel="stylesheet" href="css/about.css" />
  </head>
  <body>
    <!-- ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ -->
    <div id="home-screen" class="screen active">
      <div class="container">
        <div class="logo-section">
          <img src="icon.png" alt="Koros Matrix" class="logo-icon-img" />
          <h1 class="title">Koros Matrix</h1>
          <p class="subtitle">ุชุนูู ุญู ุงููุนุงุฏูุงุช ุจุทุฑููุฉ ุชูุงุนููุฉ ููุชุนุฉ</p>
        </div>

        <div class="matrix-animation">
          <div class="demo-matrix">
            <div class="demo-row" style="--delay: 0">
              <span class="demo-cell">2</span>
              <span class="demo-cell">1</span>
              <span class="demo-cell">3</span>
              <span class="demo-divider">โ</span>
              <span class="demo-cell">9</span>
            </div>
            <div class="demo-row" style="--delay: 1">
              <span class="demo-cell">1</span>
              <span class="demo-cell">-2</span>
              <span class="demo-cell">1</span>
              <span class="demo-divider">โ</span>
              <span class="demo-cell">3</span>
            </div>
            <div class="demo-row" style="--delay: 2">
              <span class="demo-cell">3</span>
              <span class="demo-cell">1</span>
              <span class="demo-cell">-2</span>
              <span class="demo-divider">โ</span>
              <span class="demo-cell">4</span>
            </div>
          </div>
        </div>

        <div class="menu-buttons">
          <button
            class="btn btn-primary btn-large"
            onclick="game.showPartsSelect()"
          >
            <span class="btn-icon">๐ฎ</span>
            <span>ุงุจุฏุฃ ุงููุนุจ</span>
          </button>
          <button class="btn btn-secondary" onclick="game.showAbout()">
            <span class="btn-icon">โน๏ธ</span>
            <span>ุญูู</span>
          </button>
        </div>

        <!-- ููุฏ ุงููุชุญ ุงูุณุฑู -->
        <div class="cheat-code-area">
          <input
            type="password"
            id="cheat-code-input"
            class="cheat-code-input"
            placeholder="๐"
            maxlength="3"
            onkeyup="if(typeof game !== 'undefined') game.checkCheatCode(event)"
          />
        </div>
      </div>
    </div>

    <!-- ุดุงุดุฉ ุงุฎุชูุงุฑ ุงูุฌุฒุก -->
    <div id="parts-select-screen" class="screen">
      <div class="container">
        <div class="screen-header">
          <button class="btn btn-back" onclick="game.showHome()">
            <span>โ</span> ุฑุฌูุน
          </button>
          <h2>ุงุฎุชุฑ ุทุฑููุฉ ุงูุญู</h2>
        </div>

        <div class="parts-grid" id="parts-grid">
          <!-- ุงูุฌุฒุก 1: ุทุฑููุฉ ุฌุงูุณ -->
          <div class="part-card" onclick="game.selectPart(1)">
            <div class="part-icon">๐</div>
            <div class="part-name">ุทุฑููุฉ ุฌุงูุณ</div>
            <div class="part-desc">ุงูุดูู ุงููุฏุฑุฌู ุงูุตูู</div>
            <div class="part-status">ููุชูุญ โ</div>
          </div>

          <!-- ุงูุฌุฒุก 2: ุฌุงูุณ-ุฌูุฑุฏู -->
          <div
            class="part-card locked"
            id="part-card-2"
            onclick="game.selectPart(2)"
          >
            <div class="part-icon">๐ฏ</div>
            <div class="part-name">ุฌุงูุณ-ุฌูุฑุฏู</div>
            <div class="part-desc">ุงูุดูู ุงููุฏุฑุฌู ุงููุฎุชุตุฑ</div>
            <div class="part-status">๐ ุงุฌูุน 20 ูุฌูุฉ ูู ุฌุงูุณ</div>
          </div>

          <!-- ุงูุฌุฒุก 3: ุงููุญุฏุฏุงุช -->
          <div
            class="part-card locked"
            id="part-card-3"
            onclick="game.selectPart(3)"
          >
            <div class="part-icon">๐งฎ</div>
            <div class="part-name">ุงููุญุฏุฏุงุช</div>
            <div class="part-desc">ุญุณุงุจ ูุญุฏุฏุงุช ุงููุตูููุงุช</div>
            <div class="part-status">๐ ุงุฌูุน 20 ูุฌูุฉ ูู ุฌุงูุณ</div>
          </div>

          <!-- ุงูุฌุฒุก 4: ูุฑุงูุฑ -->
          <div
            class="part-card locked"
            id="part-card-4"
            onclick="game.selectPart(4)"
          >
            <div class="part-icon">๐</div>
            <div class="part-name">ูุฑุงูุฑ</div>
            <div class="part-desc">ุญู ุงููุนุงุฏูุงุช ุจุงููุญุฏุฏุงุช</div>
            <div class="part-status">๐ ุงุฌูุน 20 ูุฌูุฉ ูู ุฌุงูุณ</div>
          </div>

          <!-- ุงูุฌุฒุก 5: ุทุฑููุฉ ุงููุนููุณ -->
          <div
            class="part-card locked"
            id="part-card-5"
            onclick="game.selectPart(5)"
          >
            <div class="part-icon">๐</div>
            <div class="part-name">ุงููุนููุณ</div>
            <div class="part-desc">ุญู ุงููุนุงุฏูุงุช ุจุงููุนููุณ</div>
            <div class="part-status">๐ ุงุฌูุน 20 ูุฌูุฉ ูู ุงููุญุฏุฏุงุช</div>
          </div>
        </div>
      </div>
    </div>

    <!-- ุดุงุดุฉ ุงุฎุชูุงุฑ ุงููุณุชูู -->
    <div id="level-select-screen" class="screen">
      <div class="container">
        <div class="screen-header">
          <button class="btn btn-back" onclick="game.showPartsSelect()">
            <span>โ</span> ุฑุฌูุน
          </button>
          <h2 id="level-select-title">ุงุฎุชุฑ ุงููุณุชูู</h2>
        </div>

        <div class="levels-grid" id="levels-grid">
          <!-- ุณูุชู ููุคูุง ุจูุงุณุทุฉ JavaScript -->
        </div>
      </div>
    </div>

    <!-- ุดุงุดุฉ ุงูุดุฑุญ -->
    <div id="tutorial-screen" class="screen">
      <div class="container">
        <div class="screen-header">
          <button class="btn btn-back" onclick="game.showHome()">
            <span>โ</span> ุฑุฌูุน
          </button>
          <h2>ููู ุชูุนุจุ</h2>
        </div>

        <div class="tutorial-content">
          <div class="tutorial-section">
            <h3>๐ฏ ุงููุฏู</h3>
            <p>
              ุญููู ุงููุตูููุฉ ุฅูู ุงูุดูู ุงููุฏุฑุฌู ุงูุตูู (Row Echelon Form) ุซู ุฃูุฌุฏ
              ููู ุงููุชุบูุฑุงุช.
            </p>
          </div>

          <div class="tutorial-section">
            <h3>๐ ุงูุนูููุงุช ุงููุชุงุญุฉ</h3>
            <div class="operations-list">
              <div class="operation-item">
                <div class="op-icon">โ๏ธ</div>
                <div class="op-text">
                  <strong>ุชุจุฏูู ุตููู</strong>
                  <p>ุงุณุญุจ ูุฃููุช ุงูุตููู ูุชุจุฏูููุง</p>
                </div>
              </div>
              <div class="operation-item">
                <div class="op-icon">โ</div>
                <div class="op-text">
                  <strong>ุถุฑุจ ุตู ุจุนุฏุฏ</strong>
                  <p>ุงุถุฑุจ ุฌููุน ุนูุงุตุฑ ุตู ุจุนุฏุฏ (ูููู ุฃู ูููู ูุณุฑุงู)</p>
                </div>
              </div>
              <div class="operation-item">
                <div class="op-icon">โ</div>
                <div class="op-text">
                  <strong>ุฌูุน ุตููู</strong>
                  <p>ุฃุถู ูุถุงุนู ุตู ุฅูู ุตู ุขุฎุฑ</p>
                </div>
              </div>
            </div>
          </div>

          <div class="tutorial-section">
            <h3>โจ ุงูุชูููุญุงุช</h3>
            <ul>
              <li>
                ุงูุนูุงุตุฑ <span class="highlight-green">ุงูุฎุถุฑุงุก</span> ูู ููุงููุง
                ุงูุตุญูุญ
              </li>
              <li>ุงุจุฏุฃ ุจุฌุนู ุงูุนูุตุฑ ุงูุฃูู ูู ุงูุตู ุงูุฃูู = 1</li>
              <li>ุงุฌุนู ุฌููุน ุงูุนูุงุตุฑ ุชุญุช ุงููุงุฆุฏ = 0</li>
            </ul>
          </div>

          <button
            class="btn btn-primary btn-large"
            onclick="game.showLevelSelect()"
          >
            ูููุชุ ููุจุฏุฃ! ๐
          </button>
        </div>
      </div>
    </div>

    <!-- ุดุงุดุฉ ุญูู -->
    <div id="about-screen" class="screen">
      <div class="container">
        <button class="btn btn-back" onclick="game.showHome()">
          <span>โ</span> ุฑุฌูุน
        </button>

        <div class="about-card">
          <div class="about-header">
            <h2 class="about-title">KOROS MATRIX</h2>
          </div>

          <div class="about-content">
            <!-- ุงูุนููุฏ ุงูุฃูุณุฑ: ุงููููุฉ ูุงูุชูุงุตู -->
            <div class="about-identity">
              <div class="qr-container">
                <img
                  src="Assets/Telegram QR.png"
                  alt="Telegram QR"
                  class="qr-image"
                />
                <div class="qr-overlay">
                  <span>ูุณุญ ููุชูููุฌุฑุงู</span>
                </div>
              </div>

              <div class="social-links">
                <a
                  href="https://t.me/KorosSama"
                  target="_blank"
                  class="social-btn btn-telegram"
                >
                  <svg class="social-icon" viewBox="0 0 24 24">
                    <path
                      d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.638 0l-.025.001h-.006H12zm5.786 6.993l-2.183 10.3c-.156.705-.572.875-1.157.545l-3.2-2.358-1.543 1.487c-.171.17-.314.313-.642.313l.228-3.262 5.937-5.365c.258-.228-.056-.355-.4-.128L8.625 13.91 5.464 12.92c-.689-.214-.703-.69.144-1.018l12.115-4.665c.561-.202 1.05.12 1.05.12l.007.636z"
                    />
                  </svg>
                  <span>Telegram</span>
                </a>

                <a
                  href="https://github.com/Koros1Sama"
                  target="_blank"
                  class="social-btn btn-github"
                >
                  <svg class="social-icon" viewBox="0 0 24 24">
                    <path
                      d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"
                    />
                  </svg>
                  <span>GitHub</span>
                </a>
              </div>
            </div>

            <!-- ุงูุนููุฏ ุงูุฃููู: ุงููุนูููุงุช -->
            <div class="about-info">
              <div class="info-item">
                <div class="info-label">๐จโ๐ป ุงููุจุฑูุฌ</div>
                <div class="info-value">ุนุจุฏุงูุฑุญูู ุงููุฎูุงูู</div>
              </div>

              <div class="info-item">
                <div class="info-label">๐ฉโ๐ซ ุฅุดุฑุงู ููุฑุงุฌุนุฉ</div>
                <div class="info-value">ุงูุฏูุชูุฑุฉ ุญูุงู ุงูุตุฑูู</div>
              </div>

              <div class="info-item">
                <div class="info-label">๐ ุชุงุฑูุฎ ุงูุฅุตุฏุงุฑ</div>
                <div class="info-value">ููุงูุฉ ุนุงู 2025</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ุดุงุดุฉ ุงูุฏุฑุณ ุงูุชุนูููู (Level 0) -->
    <div id="lesson-screen" class="screen">
      <div class="container">
        <div class="screen-header">
          <h2>๐ ุชุนูู ุทุฑููุฉ ุฌุงูุณ</h2>
        </div>

        <div class="lesson-container">
          <!-- ุงูุฎุทูุฉ 1: ูุง ูู ุงูุดูู ุงููุฏุฑุฌูุ -->
          <div class="lesson-step active" id="lesson-step-1">
            <h3 class="lesson-title">ุงูุฎุทูุฉ 1: ูุง ูู ุงูุดูู ุงููุฏุฑุฌู ุงูุตููุ</h3>
            <p class="lesson-desc">
              ูุฏููุง ุชุญููู ุงููุตูููุฉ ุฅูู ุดูู ุฎุงุต ูุณููู ุฅูุฌุงุฏ ููู ุงููุชุบูุฑุงุช:
            </p>

            <div class="lesson-matrix-demo">
              <div class="demo-matrix echelon-form">
                <div class="demo-row">
                  <span class="demo-cell pivot">1</span>
                  <span class="demo-cell">2</span>
                  <span class="demo-cell">3</span>
                  <span class="demo-divider"></span>
                  <span class="demo-cell result">6</span>
                </div>
                <div class="demo-row">
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell pivot">1</span>
                  <span class="demo-cell">-1</span>
                  <span class="demo-divider"></span>
                  <span class="demo-cell result">2</span>
                </div>
                <div class="demo-row">
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell pivot">1</span>
                  <span class="demo-divider"></span>
                  <span class="demo-cell result">3</span>
                </div>
              </div>

              <div class="demo-annotations">
                <div class="annotation pivot-line">
                  <span class="arrow">โ</span>
                  <span>ูู ูุงุฆุฏ ุนูู <strong>ูููู</strong> ุงูุฐู ูุจูู</span>
                </div>
              </div>
            </div>

            <div class="lesson-points">
              <div class="point">
                <span class="point-icon">โ</span>
                <span
                  >ูู <strong>ูุงุฆุฏ</strong> (ุฃูู ุนูุตุฑ ุบูุฑ ุตูุฑู ูู ุงูุตู) =
                  <strong>1</strong></span
                >
              </div>
              <div class="point">
                <span class="point-icon">โ</span>
                <span
                  >ุงููุงุฆุฏ ูู ูู ุตู <strong>ุนูู ูููู</strong> ุงููุงุฆุฏ ุงูุฐู
                  ูููู</span
                >
              </div>
              <div class="point">
                <span class="point-icon">โ</span>
                <span>ุงูุตููู ุงูุตูุฑูุฉ ุฅู ูุฌุฏุช ุชููู ูู ุงูุตููู ุงูุงุฎูุฑุฉ</span>
              </div>
              <div class="point">
                <span class="point-icon">๐ก</span>
                <span
                  >ูู ุงูุนูุงุตุฑ <strong>ุชุญุช</strong> ุฃู ูุงุฆุฏ =
                  <strong>0</strong></span
                >
              </div>
              <div class="point">
                <span class="point-icon">๐ก</span>
                <span
                  >ุงููุงุฆุฏ <strong>ููุณ ุดุฑุทุงู</strong> ุฃู ูููู ุนูู ุงููุทุฑ
                  ุงูุฑุฆูุณู!</span
                >
              </div>
            </div>
          </div>

          <!-- ุงูุฎุทูุฉ 2: ุงูุนูููุงุช ุงูุฃูููุฉ -->
          <div class="lesson-step" id="lesson-step-2">
            <h3 class="lesson-title">ุงูุฎุทูุฉ 2: ุงูุนูููุงุช ุงููุณููุญุฉ</h3>
            <p class="lesson-desc">
              ููููู ุงุณุชุฎุฏุงู 3 ุนูููุงุช ููุท ูููุตูู ููุดูู ุงููุฏุฑุฌู:
            </p>

            <div class="operations-demo">
              <div class="op-demo-item">
                <div class="op-demo-icon">โ๏ธ</div>
                <div class="op-demo-content">
                  <strong>ุชุจุฏูู ุตููู</strong>
                  <div class="op-demo-example">Rโ โ Rโ</div>
                </div>
              </div>

              <div class="op-demo-item">
                <div class="op-demo-icon">โ</div>
                <div class="op-demo-content">
                  <strong>ุถุฑุจ ุตู ุจุนุฏุฏ โ 0</strong>
                  <div class="op-demo-example">Rโ โ ยฝ ร Rโ</div>
                </div>
              </div>

              <div class="op-demo-item">
                <div class="op-demo-icon">โ</div>
                <div class="op-demo-content">
                  <strong>ุฌูุน ูุถุงุนู ุตู ูุขุฎุฑ</strong>
                  <div class="op-demo-example">Rโ โ Rโ + (-3) ร Rโ</div>
                </div>
              </div>
            </div>

            <div class="lesson-tip">
              ๐ก <strong>ูุตูุญุฉ:</strong> ุงุจุฏุฃ ุฏุงุฆูุงู ุจุฌุนู ุงููุงุฆุฏ ุงูุฃูู = 1ุ ุซู
              ุงุฌุนู ูุง ุชุญุชู = 0
            </div>

            <div class="lesson-tip drag-tip">
              ๐ฑ๏ธ <strong>ุทุฑููุฉ ุงูุงุณุชุฎุฏุงู:</strong>
              <ul
                style="
                  margin: 8px 0 0 0;
                  padding-right: 20px;
                  text-align: right;
                "
              >
                <li>
                  <strong>ุชุจุฏูู ุตููู:</strong> ุงุณุญุจ ุฃู ุตู ูุฃููุชู ุนูู ุตู ุขุฎุฑ
                </li>
                <li><strong>ุฌูุน ุตููู:</strong> ุงุณุญุจ ุฒุฑ โ ูู ุตู ูุตู ุขุฎุฑ</li>
                <li>ุฃู ุงุณุชุฎุฏู ุงูุฃุฒุฑุงุฑ ูู ุงูุฃุณูู</li>
              </ul>
            </div>
          </div>

          <!-- ุงูุฎุทูุฉ 3: ุญุงูุฉ ุงูุญู ุงููุญูุฏ -->
          <div class="lesson-step" id="lesson-step-3">
            <h3 class="lesson-title">ุงูุฎุทูุฉ 3: ุญุงูุฉ ุงูุญู ุงููุญูุฏ โ</h3>
            <p class="lesson-desc">
              ุนูุฏูุง ูููู ููู ูุชุบูุฑ ูุงุฆุฏ ุฎุงุต ุจูุ ููุฌุฏ <strong>ุญู ูุญูุฏ</strong>:
            </p>

            <div class="lesson-matrix-demo">
              <div class="demo-matrix unique-solution">
                <div class="demo-row">
                  <span class="demo-cell pivot">1</span>
                  <span class="demo-cell">2</span>
                  <span class="demo-cell">1</span>
                  <span class="demo-divider"></span>
                  <span class="demo-cell result">9</span>
                </div>
                <div class="demo-row">
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell pivot">1</span>
                  <span class="demo-cell">-1</span>
                  <span class="demo-divider"></span>
                  <span class="demo-cell result">1</span>
                </div>
                <div class="demo-row">
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell pivot">1</span>
                  <span class="demo-divider"></span>
                  <span class="demo-cell result">3</span>
                </div>
              </div>
            </div>

            <div class="solution-box success">
              <div class="solution-icon">โ</div>
              <div class="solution-content">
                <strong>ุงูุญู:</strong>
                <div class="solution-vars">
                  <span>z = 3</span>
                  <span>y = 1 + z = 4</span>
                  <span>x = 9 - 2y - z = -2</span>
                </div>
              </div>
            </div>
          </div>

          <!-- ุงูุฎุทูุฉ 4: ูุง ููุงุฆู ูู ุงูุญููู -->
          <div class="lesson-step" id="lesson-step-4">
            <h3 class="lesson-title">ุงูุฎุทูุฉ 4: ูุง ููุงุฆู ูู ุงูุญููู โพ๏ธ</h3>
            <p class="lesson-desc">
              ุฅุฐุง ูุงู ุงูุตู ุงูุฃุฎูุฑ <strong>ููู ุฃุตูุงุฑ</strong> (ุจูุง ููู ุงููุงุชุฌ):
            </p>

            <div class="lesson-matrix-demo">
              <div class="demo-matrix infinite-solution">
                <div class="demo-row">
                  <span class="demo-cell pivot">1</span>
                  <span class="demo-cell">2</span>
                  <span class="demo-cell">1</span>
                  <span class="demo-divider"></span>
                  <span class="demo-cell result">5</span>
                </div>
                <div class="demo-row">
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell pivot">1</span>
                  <span class="demo-cell">3</span>
                  <span class="demo-divider"></span>
                  <span class="demo-cell result">2</span>
                </div>
                <div class="demo-row warning-row">
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell zero">0</span>
                  <span class="demo-divider"></span>
                  <span class="demo-cell zero">0</span>
                </div>
              </div>
            </div>

            <div class="solution-box warning">
              <div class="solution-icon">โพ๏ธ</div>
              <div class="solution-content">
                <strong>ูุนูู ุฐูู:</strong>
                <p>
                  ุฃุญุฏ ุงููุนุงุฏูุงุช ูุชูุฑุฑุฉ (ุฃู ุชุงุจุนุฉ). ุงููุชุบูุฑ z ุญุฑ ูููู ุฃู ูุฃุฎุฐ ุฃู
                  ูููุฉ!
                </p>
                <div class="solution-vars">
                  <span>z = t (ุฃู ุนุฏุฏ)</span>
                  <span>y = 2 - 3t</span>
                  <span>x = 5 - 2y - z = 1 + 5t</span>
                </div>
              </div>
            </div>
          </div>

          <!-- ุงูุฎุทูุฉ 5: ูุง ููุฌุฏ ุญู -->
          <div class="lesson-step" id="lesson-step-5">
            <h3 class="lesson-title">ุงูุฎุทูุฉ 5: ูุง ููุฌุฏ ุญู โ</h3>
            <p class="lesson-desc">
              ุฅุฐุง ูุงู ุงูุตู ุงูุฃุฎูุฑ <strong>ุฃุตูุงุฑ ูุง ุนุฏุง ุงููุงุชุฌ</strong>:
            </p>

            <div class="lesson-matrix-demo">
              <div class="demo-matrix no-solution">
                <div class="demo-row">
                  <span class="demo-cell pivot">1</span>
                  <span class="demo-cell">2</span>
                  <span class="demo-cell">1</span>
                  <span class="demo-divider"></span>
                  <span class="demo-cell result">5</span>
                </div>
                <div class="demo-row">
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell pivot">1</span>
                  <span class="demo-cell">3</span>
                  <span class="demo-divider"></span>
                  <span class="demo-cell result">2</span>
                </div>
                <div class="demo-row error-row">
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell zero">0</span>
                  <span class="demo-divider"></span>
                  <span class="demo-cell error">5</span>
                </div>
              </div>
            </div>

            <div class="solution-box error">
              <div class="solution-icon">โ</div>
              <div class="solution-content">
                <strong>ูุนูู ุฐูู:</strong>
                <p>ุงูุตู ุงูุฃุฎูุฑ ูููู: <code>0 = 5</code> ููุฐุง ูุณุชุญูู!</p>
                <p>ุงููุนุงุฏูุงุช ูุชูุงูุถุฉุ ูุง ููุฌุฏ ุญู ูุญูู ุฌููุนูุง.</p>
              </div>
            </div>
          </div>

          <!-- ุงูุฎุทูุฉ 6: ุดุงูุฏ ุงูุญู ุฎุทูุฉ ุจุฎุทูุฉ (ุณูููุงุฆู) -->
          <div class="lesson-step" id="lesson-step-6">
            <h3 class="lesson-title">ุงูุฎุทูุฉ 6: ๐ฌ ุดุงูุฏ ุงูุญู ูุชุญุฑูุงู</h3>
            <p class="lesson-desc">
              ุดุงูุฏ ููู ุชุชุญูู ุงููุตูููุฉ ุฎุทูุฉ ุจุฎุทูุฉ ูุน ุญุฑูุงุช ุชูุถูุญูุฉ!
            </p>

            <!-- ุญุงููุฉ ุงูุดุฑุญ ุงูุณูููุงุฆู - ูุชู ููุคูุง ุจูุงุณุทุฉ JavaScript -->
            <div id="cinematic-tutorial-container"></div>

            <script>
              // Initialize cinematic tutorial when this step becomes visible
              document.addEventListener("DOMContentLoaded", function () {
                const observer = new MutationObserver(function (mutations) {
                  mutations.forEach(function (mutation) {
                    if (
                      mutation.target.classList.contains("active") &&
                      mutation.target.id === "lesson-step-6"
                    ) {
                      if (
                        typeof cinematicTutorial !== "undefined" &&
                        !document.querySelector(".cinematic-tutorial")
                      ) {
                        cinematicTutorial.init("cinematic-tutorial-container");
                      }
                    }
                  });
                });

                const lessonStep6 = document.getElementById("lesson-step-6");
                if (lessonStep6) {
                  observer.observe(lessonStep6, {
                    attributes: true,
                    attributeFilter: ["class"],
                  });

                  // Initialize if already active
                  if (
                    lessonStep6.classList.contains("active") &&
                    typeof cinematicTutorial !== "undefined"
                  ) {
                    cinematicTutorial.init("cinematic-tutorial-container");
                  }
                }
              });
            </script>
          </div>

          <!-- ุงูุฎุทูุฉ 7: ุงููุงุฆุฏ ููุณ ุฏุงุฆูุงู ุนูู ุงููุทุฑ -->
          <div class="lesson-step" id="lesson-step-7">
            <h3 class="lesson-title">ุงูุฎุทูุฉ 7: ๐ก ุญุงูุงุช ุฎุงุตุฉ ูููุงุฏุฉ</h3>
            <p class="lesson-desc">
              ุงููุงุฆุฏ ูููู ุฃู ูููู ูู ุฃู ุนููุฏุ ููุณ ุจุงูุถุฑูุฑุฉ ุนูู ุงููุทุฑ:
            </p>

            <div class="lesson-matrix-demo">
              <div class="demo-matrix">
                <div class="demo-row">
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell pivot">1</span>
                  <span class="demo-cell">2</span>
                  <span class="demo-cell">3</span>
                  <span class="demo-divider"></span>
                  <span class="demo-cell result">5</span>
                </div>
                <div class="demo-row">
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell pivot">1</span>
                  <span class="demo-divider"></span>
                  <span class="demo-cell result">3</span>
                </div>
                <div class="demo-row">
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell zero">0</span>
                  <span class="demo-cell zero">0</span>
                  <span class="demo-divider"></span>
                  <span class="demo-cell zero">0</span>
                </div>
              </div>
            </div>

            <div class="lesson-points">
              <div class="point">
                <span class="point-icon">โ</span>
                <span>ูุฐุง ุดูู ูุฏุฑุฌู ุตุญูุญ! ุงููุงุฏุฉ ูู ุงูุฃุนูุฏุฉ 2 ู 4</span>
              </div>
              <div class="point">
                <span class="point-icon">โพ๏ธ</span>
                <span>ุงูุตู ุงูุตูุฑู ูุนูู: ูุชุบูุฑุงุช ุญุฑุฉ = ูุง ููุงุฆู ูู ุงูุญููู</span>
              </div>
              <div class="point">
                <span class="point-icon">๐ฏ</span>
                <span>ุงูููู: ูู ูุงุฆุฏ ุนูู <strong>ูููู</strong> ุงูุฐู ูุจูู</span>
              </div>
            </div>
          </div>

          <!-- ุงูุฎุทูุฉ 8: ุฌุงูุณ-ุฌูุฑุฏู -->
          <div class="lesson-step" id="lesson-step-8">
            <h3 class="lesson-title">
              ุงูุฎุทูุฉ 8: ๐ฏ ุฌุงูุณ-ุฌูุฑุฏู (ุงูุดูู ุงููุฎุชุตุฑ)
            </h3>
            <p class="lesson-desc">
              ุจุนุฏ ุฅุชูุงู ุทุฑููุฉ ุฌุงูุณุ ููุงู ุทุฑููุฉ ุงุฎุฑู! ูู ุฌุงูุณ-ุฌูุฑุฏู ูุตููุฑ ุงูุนูุงุตุฑ
              <strong>ููู</strong> ุงููุงุฏุฉ ุฃูุถุงู:
            </p>

            <div class="lesson-comparison">
              <div class="comparison-item">
                <div class="comparison-title">ุฌุงูุณ (ุงูุดูู ุงููุฏุฑุฌู)</div>
                <div class="demo-matrix">
                  <div class="demo-row">
                    <span class="demo-cell pivot">1</span>
                    <span class="demo-cell">2</span>
                    <span class="demo-divider"></span>
                    <span class="demo-cell result">5</span>
                  </div>
                  <div class="demo-row">
                    <span class="demo-cell zero">0</span>
                    <span class="demo-cell pivot">1</span>
                    <span class="demo-divider"></span>
                    <span class="demo-cell result">2</span>
                  </div>
                </div>
                <div class="comparison-note">โ๏ธ ูุญุชุงุฌ ุชุนููุถ ุนูุณู</div>
              </div>

              <div class="comparison-arrow">โ</div>

              <div class="comparison-item highlight-item">
                <div class="comparison-title">ุฌุงูุณ-ุฌูุฑุฏู (ุงููุฎุชุตุฑ)</div>
                <div class="demo-matrix success-matrix">
                  <div class="demo-row">
                    <span class="demo-cell pivot">1</span>
                    <span class="demo-cell zero">0</span>
                    <span class="demo-divider"></span>
                    <span class="demo-cell result">1</span>
                  </div>
                  <div class="demo-row">
                    <span class="demo-cell zero">0</span>
                    <span class="demo-cell pivot">1</span>
                    <span class="demo-divider"></span>
                    <span class="demo-cell result">2</span>
                  </div>
                </div>
                <div class="comparison-note success">
                  โ ุงูุญู ูุจุงุดุฑ: x=1, y=2
                </div>
              </div>
            </div>

            <div class="lesson-points">
              <div class="point">
                <span class="point-icon">๐</span>
                <span>ุงููุฑู: ูุตููุฑ <strong>ููู ูุชุญุช</strong> ูู ูุงุฆุฏ</span>
              </div>
              <div class="point">
                <span class="point-icon">โก</span>
                <span>ุงูููุฒุฉ: ุงูุญู ูุงุถุญ ูุจุงุดุฑุฉ ุจุฏูู ุชุนููุถ</span>
              </div>
              <div class="point">
                <span class="point-icon">๐</span>
                <span>ุฌุฑูุจ ุงูุฌุฒุก ุงูุซุงูู ูู ุงููุนุจุฉ ูุฅุชูุงููุง!</span>
              </div>
            </div>
          </div>

          <!-- ุฃุฒุฑุงุฑ ุงูุชููู -->
          <div class="lesson-navigation">
            <button
              class="btn btn-nav"
              id="btn-prev-lesson"
              onclick="game.prevLesson()"
              disabled
            >
              โ ุงูุณุงุจู
            </button>

            <div class="lesson-dots" id="lesson-dots">
              <span class="dot active" onclick="game.goToLesson(1)"></span>
              <span class="dot" onclick="game.goToLesson(2)"></span>
              <span class="dot" onclick="game.goToLesson(3)"></span>
              <span class="dot" onclick="game.goToLesson(4)"></span>
              <span class="dot" onclick="game.goToLesson(5)"></span>
              <span class="dot" onclick="game.goToLesson(6)"></span>
              <span class="dot" onclick="game.goToLesson(7)"></span>
              <span class="dot" onclick="game.goToLesson(8)"></span>
            </div>

            <button
              class="btn btn-nav btn-primary"
              id="btn-next-lesson"
              onclick="game.nextLesson()"
            >
              ุงูุชุงูู โถ
            </button>
          </div>

          <!-- ุฒุฑ ุงูุจุฏุก (ูุธูุฑ ูู ุขุฎุฑ ุฎุทูุฉ) -->
          <button
            class="btn btn-primary btn-large btn-start-game"
            id="btn-start-after-lesson"
            onclick="game.showLevelSelect()"
            style="display: none"
          >
            ๐ฎ ุงุจุฏุฃ ุงููุนุจ ุงูุขู!
          </button>

          <!-- ุฒุฑ ุงูุฎุฑูุฌ ูู ุงูุฃุณูู -->
          <button
            class="btn btn-secondary btn-exit-lesson"
            onclick="game.showLevelSelect()"
          >
            โ ุฑุฌูุน ูููุณุชููุงุช
          </button>
        </div>
      </div>
    </div>

    <!-- ุดุงุดุฉ ุงููุนุจ -->
    <div id="game-screen" class="screen">
      <div class="container">
        <!-- Goal Hint Overlay -->
        <div id="goal-hint-container"></div>

        <!-- ุญุงููุฉ ูุนุจุฉ ุงููุญุฏุฏุงุช (ุชุธูุฑ ููุท ูู ุฌุฒุก ุงููุญุฏุฏุงุช) -->
        <div id="determinant-game-container" style="display: none"></div>

        <!-- ุงูุดุฑูุท ุงูุนููู -->
        <div class="game-header">
          <button class="btn btn-back" onclick="game.confirmExit()">
            <span>โ</span> ุฎุฑูุฌ
          </button>
          <div class="game-stats">
            <div class="stat">
              <span class="stat-label">ุงููุณุชูู</span>
              <span class="stat-value" id="current-level">1</span>
            </div>
            <div class="stat">
              <span class="stat-label">ุงูููุงุท</span>
              <span class="stat-value" id="current-score">0</span>
            </div>
            <div class="stat">
              <span class="stat-label">ุงูุฎุทูุงุช</span>
              <span class="stat-value" id="current-steps">0</span>
            </div>
            <!-- ุนุฑุถ ุงููุฌูู ุงูููุฑู -->
            <div class="stat live-stars-stat">
              <span id="live-stars" class="live-stars-display">โญโญโญโญโญ</span>
            </div>
          </div>
        </div>

        <!-- ูุคุดุฑ ุงููุฑุญูุฉ -->
        <div class="phase-indicator">
          <div class="phase" id="phase-2-indicator">
            <span class="phase-num">2</span>
            <span class="phase-text">ุฅูุฌุงุฏ ุงููุชุบูุฑุงุช</span>
          </div>
          <div class="phase-arrow">โ</div>
          <div class="phase active" id="phase-1-indicator">
            <span class="phase-num">1</span>
            <span class="phase-text">ุงูุดูู ุงููุฏุฑุฌู</span>
          </div>
        </div>

        <!-- ูุธุงู ุงููุนุงุฏูุงุช -->
        <div class="equations-section" id="equations-section">
          <h3>๐ ูุธุงู ุงููุนุงุฏูุงุช:</h3>
          <div class="equations-box" id="equations-display">
            <!-- ุณูุชู ููุคูุง ุจูุงุณุทุฉ JavaScript -->
          </div>
        </div>

        <!-- ุงููุฑุญูุฉ ุงูุฃููู: ุงููุตูููุฉ -->
        <div id="phase-1" class="game-phase active">
          <!-- ูุณู ุงููุนูู ุงููุณุงุนุฏ -->
          <div class="tutor-section" id="tutor-section" style="display: none">
            <div class="tutor-header">
              <span class="tutor-icon">๐ก</span>
              <span class="tutor-title">ูุนูู ุงููุตูููุงุช</span>
              <button
                class="tutor-close"
                onclick="game.hideTutor()"
                title="ุฅุฎูุงุก"
              >
                &times;
              </button>
            </div>
            <div class="tutor-body">
              <p class="tutor-hint" id="tutor-hint-text">
                ูุฑุญุจุงู! ุณุฃุณุงุนุฏู ูู ุญู ุงููุตูููุฉ.
              </p>
            </div>
            <div class="tutor-actions">
              <button
                class="btn btn-tutor-apply"
                id="btn-apply-hint"
                onclick="game.applyTutorHint()"
                style="display: none"
              >
                โ ุชุทุจูู ุงูุชูููุญ <small>(-1โญ)</small>
              </button>
            </div>
          </div>

          <div class="matrix-section">
            <h3>๐ข ุงููุตูููุฉ ุงูููุณุนุฉ:</h3>

            <!-- ุชูููุญ ุงูุณุญุจ ูุงูุฅููุงุช -->
            <div class="drag-hint-banner" id="drag-hint-banner">
              <span class="drag-hint-icon">๐</span>
              <span class="drag-hint-text"
                >ุงุณุญุจ/ุงููุณ ุตู ูุชุจุฏููู โข ุงุณุญุจ โ ูุฌูุน ุตููู</span
              >
              <button
                class="drag-hint-close"
                onclick="this.parentElement.style.display='none'"
              >
                ร
              </button>
            </div>

            <div class="matrix-container" id="matrix-container">
              <!-- ุณูุชู ููุคูุง ุจูุงุณุทุฉ JavaScript -->
            </div>
          </div>

          <!-- ุฃุฒุฑุงุฑ ุงูุนูููุงุช -->
          <div class="operations-bar">
            <button
              class="btn btn-operation"
              id="btn-scale"
              onclick="game.showScaleModal()"
            >
              <span class="op-icon">โ</span>
              <span>ุถุฑุจ ุตู</span>
            </button>
            <button
              class="btn btn-operation"
              id="btn-add"
              onclick="game.showAddModal()"
            >
              <span class="op-icon">โ</span>
              <span>ุฌูุน ุตููู</span>
            </button>
            <button
              class="btn btn-undo"
              id="btn-undo"
              onclick="game.undo()"
              disabled
            >
              <span class="op-icon">โฉ๏ธ</span>
              <span>ุชุฑุงุฌุน</span>
            </button>
            <button
              class="btn btn-hint"
              id="btn-show-hint"
              onclick="game.toggleTutor()"
              style="display: none"
            >
              <span class="op-icon">๐ก</span>
              <span>ุชูููุญ</span> <small>(-1โญ)</small>
            </button>
          </div>
        </div>

        <!-- ุงููุฑุญูุฉ ุงูุซุงููุฉ: ุงูุชุนููุถ ุงูุนูุณู -->
        <div id="phase-2" class="game-phase">
          <div class="substitution-section">
            <h3>๐งฉ ุฃูุฌุฏ ููู ุงููุชุบูุฑุงุช:</h3>
            <div class="final-matrix" id="final-matrix">
              <!-- ุงููุตูููุฉ ุงูููุงุฆูุฉ -->
            </div>
            <div class="final-equations-section">
              <h4>๐ ุงููุนุงุฏูุงุช ุงููุงุชุฌุฉ:</h4>
              <div
                class="equations-box final-equations"
                id="final-equations-display"
              >
                <!-- ุงููุนุงุฏูุงุช ุงููุงุชุฌุฉ -->
              </div>
            </div>
            <div class="variables-form" id="variables-form">
              <!-- ุญููู ุฅุฏุฎุงู ุงููุชุบูุฑุงุช -->
            </div>
            <button
              class="btn btn-primary btn-large"
              onclick="game.checkVariables()"
            >
              โ ุชุญูู ูู ุงูุฅุฌุงุจุฉ
            </button>
            <button
              class="btn btn-hint btn-large"
              id="btn-phase2-hint"
              onclick="game.showPhase2Hint()"
            >
              ๐ก ุชูููุญ <small>(-1โญ)</small>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ุดุงุดุฉ ุงูููุฒ -->
    <div id="win-screen" class="screen">
      <div class="container">
        <div class="win-content">
          <div class="win-icon">๐</div>
          <h2>ุฃุญุณูุช!</h2>
          <p class="win-message" id="win-message">ููุฏ ุฃูููุช ุงููุณุชูู ุจูุฌุงุญ</p>

          <div class="win-stats">
            <div class="win-stat">
              <span class="win-stat-value" id="final-score">0</span>
              <span class="win-stat-label">ุงูููุงุท</span>
            </div>
            <div class="win-stat">
              <span class="win-stat-value" id="final-steps">0</span>
              <span class="win-stat-label">ุงูุฎุทูุงุช</span>
            </div>
          </div>

          <div class="win-stars" id="win-stars">โญโญโญโญโญ</div>

          <!-- ุดุงุฑุงุช ุงูุฅูุฌุงุฒ -->
          <div class="win-badges" id="win-badges" style="display: none"></div>

          <!-- ููุงุนุฏ ุงูุชูููู -->
          <div class="scoring-rules" id="scoring-rules">
            <div class="rule-title">ุงูุฅุญุตุงุฆูุงุช:</div>
            <div class="rule-item">
              ๐ก <span id="rule-3-stars">ุจุฏูู ุชูููุญุงุช</span>
            </div>
            <div class="rule-item">
              โ <span id="rule-2-stars">ุจุฏูู ุฃุฎุทุงุก</span>
            </div>
            <div class="rule-item">
              ๐ฃ <span id="rule-1-star">ุงูุฎุทูุงุช</span>
            </div>
          </div>

          <div class="win-buttons">
            <button class="btn btn-secondary" onclick="game.showLevelSelect()">
              ุงุฎุชุฑ ูุณุชูู ุขุฎุฑ
            </button>
            <button class="btn btn-primary" onclick="game.nextLevel()">
              ุงููุณุชูู ุงูุชุงูู โ
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ูุงูุฐุฉ ุถุฑุจ ุตู -->
    <div id="scale-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>โ ุถุฑุจ ุตู ุจุนุฏุฏ</h3>
          <button class="modal-close" onclick="game.closeModals()">ร</button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label>ุงุฎุชุฑ ุงูุตู:</label>
            <select id="scale-row" class="form-select">
              <!-- ุณูุชู ููุคูุง ุจูุงุณุทุฉ JavaScript -->
            </select>
          </div>

          <!-- ุนุฑุถ ููู ุงูุตู ุงูุญุงููุฉ -->
          <div class="scale-row-preview">
            <div class="preview-label">ุงูุตู ุงูุญุงูู:</div>
            <div class="preview-row" id="scale-current-row">[ 1, 2, | 5 ]</div>
          </div>

          <div class="form-group">
            <label>ุงุถุฑุจ ูู k:</label>
            <div class="fraction-input-single">
              <input
                type="text"
                inputmode="text"
                id="scale-k"
                class="form-input frac-input-single"
                value=""
                placeholder="e.g. -3/4 or 2"
                oninput="game.updateScalePreview();"
                onkeydown="if(event.key==='Enter'){event.preventDefault(); game.executeScale();}"
              />
            </div>
            <div class="fraction-preview" id="scale-preview">k = 1</div>
          </div>

          <!-- ูุนุงููุฉ ุงููุชูุฌุฉ -->
          <div class="result-preview">
            <div class="preview-label">ุงููุชูุฌุฉ:</div>
            <div class="preview-row" id="scale-operation-preview">
              [ 1, 2, | 5 ]
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="game.closeModals()">
            ุฅูุบุงุก
          </button>
          <button class="btn btn-primary" onclick="game.executeScale()">
            ุชูููุฐ
          </button>
        </div>
      </div>
    </div>

    <!-- ูุงูุฐุฉ ุฌูุน ุตููู - ูุจุณุทุฉ -->
    <div id="add-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>โ ุฌูุน ุตููู</h3>
          <button class="modal-close" onclick="game.closeModals()">ร</button>
        </div>
        <div class="modal-body">
          <!-- ุนุฑุถ ููู ุงูุตููู ุงููุนููุฉ -->
          <div class="rows-preview">
            <div class="row-preview-item" id="target-row-preview">
              <span class="row-preview-label">R1:</span>
              <span class="row-preview-values" id="target-row-values"
                >[ 1, 2 | 5 ]</span
              >
            </div>
            <div class="row-preview-item" id="source-row-preview">
              <span class="row-preview-label">R2:</span>
              <span class="row-preview-values" id="source-row-values"
                >[ 2, 1 | 4 ]</span
              >
            </div>
          </div>

          <!-- ุตูุบุฉ ุงูุนูููุฉ ุงููุงุถุญุฉ -->
          <div class="operation-formula">
            <div class="formula-box">
              <select id="add-target" class="inline-select"></select>
              <span class="formula-symbol">โ</span>
              <span class="formula-text" id="formula-target-text">R1</span>
              <span class="formula-symbol">+</span>
              <span class="formula-bracket">(</span>
              <input
                type="text"
                inputmode="text"
                id="add-k"
                class="inline-input frac-input-single"
                value=""
                placeholder="-3/4"
                oninput="game.updateAddPreview();"
                onkeydown="if(event.key==='Enter'){event.preventDefault(); game.executeAdd();}"
              />
              <span class="formula-bracket">)</span>
              <span class="formula-symbol">ร</span>
              <select id="add-source" class="inline-select"></select>
            </div>
          </div>

          <!-- ุดุฑุญ ูุจุณุท -->
          <div class="operation-explain">
            <p id="operation-explain-text">
              ุณูุชู ุฅุถุงูุฉ <strong>-1</strong> ูุถุฑูุจ ูู <strong>R2</strong> ุฅูู
              <strong>R1</strong>
            </p>
          </div>

          <!-- ูุนุงููุฉ ุงููุชูุฌุฉ -->
          <div class="result-preview">
            <div class="preview-label">ุงููุชูุฌุฉ:</div>
            <div class="preview-row" id="add-operation-preview">
              <!-- ุณูุชู ููุคูุง ุจูุงุณุทุฉ JavaScript -->
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="game.closeModals()">
            ุฅูุบุงุก
          </button>
          <button class="btn btn-primary" onclick="game.executeAdd()">
            ุชูููุฐ
          </button>
        </div>
      </div>
    </div>

    <!-- ูุงูุฐุฉ ุชุฃููุฏ ุงูุฎุฑูุฌ -->
    <div id="confirm-modal" class="modal">
      <div class="modal-content modal-small">
        <div class="modal-header">
          <h3>โ๏ธ ุชุฃููุฏ ุงูุฎุฑูุฌ</h3>
        </div>
        <div class="modal-body">
          <p>ูู ุฃูุช ูุชุฃูุฏ ูู ุงูุฎุฑูุฌุ ุณูุชู ููุฏุงู ุชูุฏูู ูู ูุฐุง ุงููุณุชูู.</p>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="game.closeModals()">
            ุงูุจูุงุก
          </button>
          <button class="btn btn-danger" onclick="game.exitToLevelSelect()">
            ุฎุฑูุฌ
          </button>
        </div>
      </div>
    </div>

    <div class="game-footer">
      Created by <span class="signature">Koros Sama</span>
    </div>

    <!-- ุญุงููุฉ ุดุฑุญ ุงูุชุจุณูุท ุงููุชุญุฑู (Cinematic) -->
    <div id="det-simplify-container"></div>

    <!-- ุญุงููุฉ ุชุนููู ุงููุญุฏุฏุงุช (Modal) -->
    <div id="determinant-tutorial-container"></div>

    <script src="js/matrix.js"></script>
    <script src="js/levels.js"></script>
    <script src="js/dragdrop.js"></script>
    <script src="js/cinematic-tutorial.js"></script>
    <script src="js/lesson-animator.js"></script>
    <script src="js/determinant-levels.js"></script>
    <script src="js/determinant-game.js"></script>
    <script src="js/determinant-tutorial.js"></script>
    <script src="js/det-simplify-tutorial.js"></script>
    <script src="js/cramer-levels.js"></script>
    <script src="js/cramer-game.js"></script>
    <script src="js/cramer-tutorial.js"></script>
    <script src="js/inverse-levels.js"></script>
    <script src="js/inverse-game.js"></script>
    <script src="js/inverse-tutorial.js"></script>
    <script src="js/custom-level.js"></script>
    <script src="js/app.js"></script>
    <!-- ุชุณุฌูู Service Worker ูู PWA -->
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("./sw.js")
            .then((registration) => {
              console.log("ServiceWorker registration successful");
            })
            .catch((err) => {
              console.log("ServiceWorker registration failed: ", err);
            });
        });
      }

      // === ุชุฃููุฏ ุงูุฎุฑูุฌ ูู ุงูุชุทุจูู ===
      let lastBackPress = 0;

      // Handle back button on Android
      window.addEventListener("popstate", function (e) {
        const homeScreen = document.getElementById("home-screen");
        if (homeScreen && homeScreen.classList.contains("active")) {
          // On home screen - show exit confirmation
          const now = Date.now();
          if (now - lastBackPress < 2000) {
            // Double back press - exit (or go back)
            window.history.back();
          } else {
            lastBackPress = now;
            // Show toast message
            showExitToast();
            window.history.pushState(null, "", window.location.href);
          }
        }
      });

      // Push initial state
      window.history.pushState(null, "", window.location.href);

      function showExitToast() {
        let toast = document.getElementById("exit-toast");
        if (!toast) {
          toast = document.createElement("div");
          toast.id = "exit-toast";
          toast.style.cssText = `
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 14px;
            z-index: 99999;
            transition: opacity 0.3s;
          `;
          document.body.appendChild(toast);
        }
        toast.textContent = "ุงุถุบุท ูุฑุฉ ุฃุฎุฑู ููุฎุฑูุฌ";
        toast.style.opacity = "1";
        setTimeout(() => {
          toast.style.opacity = "0";
        }, 2000);
      }

      // Prevent accidental page refresh on mobile
      window.addEventListener("beforeunload", function (e) {
        if (typeof game !== "undefined" && game.isPlaying) {
          e.preventDefault();
          e.returnValue =
            "ูู ุฃูุช ูุชุฃูุฏ ูู ุงูุฎุฑูุฌุ ุณูุชู ููุฏ ุชูุฏูู ูู ุงููุณุชูู ุงูุญุงูู.";
          return e.returnValue;
        }
      });
    </script>
  </body>
</html>
